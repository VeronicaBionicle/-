; Программа счета нажатия в двоичном коде
.device ATmega8
.include "m8def.inc"
; частота 4 МГц
.def temp = r16 ; рабочая переменная
.def Razr0 = r17 ; разряды задержки
.def Razr1 = r18
.def Razr2 = r19
.def Counter = r20; счетчик
;+++++++++Программа+++++++++++
ldi temp, 0b00000100 ; для вторго разряда порта D 
out PORTD, temp ; подтягивающий резистор (если порт находится в режиме входа, то PORTD определяет подключение подтягивающего резистора)
ldi temp,0b00000111; порт B на выход  
out DDRB, temp  ; DDRX определяет режим работы порта
clr Counter ; очищаем счетчик
Pincykle: ; цикл отслеживания кнопки
sbic PIND,2; пропустить если нажата
rjmp Pincykle ; вернуться обратно если не нажата
; кнопака нажата пауза 0,2с, N = $027100
ldi Razr2, $02
ldi Razr1, $71
ldi Razr0, $00
Pin_release: ; отслеживаем отпускание
sbis PIND,2 ; пропускаем если отпущена
rjmp Pincykle ; вернуться обратно если нажата
inc Counter; если отпущена увеличиваем счетчик
out PORTB, Counter ; выводим счетчик в порт B
; пауза 0,5 c N = $061A80h
ldi Razr2, $06
ldi Razr1,$1A
ldi Razr0,$80
rjmp Pincykle ; вернуться обратно к отслеживанию
ret ; возврат из процедуры
